<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Configuratore Impianto Radiante</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>Configuratore Impianto Radiante a Pavimento</h1>

        <form id="radiantForm">
            <!-- Sezione 1: Informazioni Generali -->
            <fieldset>
                <legend>1. Informazioni Generali del Progetto</legend>
                <div>
                    <label for="projectName">Nome Progetto:</label>
                    <input type="text" id="projectName" name="projectName" value="Casa Prova">
                </div>
                <div>
                    <label for="buildingType">Tipo di Edificio:</label>
                    <select id="buildingType" name="buildingType">
                        <option value="new">Nuova Costruzione</option>
                        <option value="renovation">Ristrutturazione</option>
                    </select>
                </div>
                <div>
                    <label for="insulationLevel">Livello di Isolamento:</label>
                    <select id="insulationLevel" name="insulationLevel">
                        <option value="excellent">Ottimo (A/B)</option>
                        <option value="good">Buono (C/D)</option>
                        <option value="poor">Scarso (E+)</option>
                    </select>
                </div>
                <div>
                    <label for="heatSource">Fonte di Calore Prevista:</label>
                    <select id="heatSource" name="heatSource">
                        <option value="condensing_boiler">Caldaia a Condensazione</option>
                        <option value="heat_pump">Pompa di Calore</option>
                        <option value="other">Altro</option>
                    </select>
                </div>
                <div>
                    <label for="flowTemperature">Temperatura di Mandata Prevista (°C):</label>
                    <input type="number" id="flowTemperature" name="flowTemperature" value="35" min="25" max="55">
                </div>
                <div>
                    <label for="screedHeight">Altezza Disponibile per Massetto (cm, sopra solaio grezzo):</label>
                    <input type="number" id="screedHeight" name="screedHeight" value="8" min="4">
                </div>
            </fieldset>

            <!-- Sezione 2: Definizione Stanze -->
            <fieldset>
                <legend>2. Definizione Stanze e Superfici</legend>
                <div id="roomsContainer">
                    <!-- Il primo blocco stanza (template) -->
                    <div class="room-entry">
                        <h4>Stanza 1</h4>
                        <div>
                            <label for="roomName1">Nome Stanza:</label>
                            <input type="text" class="roomName" name="roomName1" value="Soggiorno">
                        </div>
                        <div>
                            <label for="roomSurface1">Superficie (mq):</label>
                            <input type="number" class="roomSurface" name="roomSurface1" value="25" min="1" step="0.1" required>
                        </div>
                        <div>
                            <label for="roomFlooring1">Tipo Pavimentazione:</label>
                            <select class="roomFlooring" name="roomFlooring1">
                                <option value="tiles">Piastrelle/Gres/Pietra</option>
                                <option value="parquet">Parquet (<15mm)</option>
                                <option value="laminate">Laminato (adatto)</option>
                                <option value="resin">Resina</option>
                                <option value="carpet_low_res">Moquette (bassa res.)</option>
                            </select>
                        </div>
                        <button type="button" class="remove-room-btn" style="display:none;">Rimuovi Stanza</button>
                    </div>
                </div>
                <button type="button" id="addRoomBtn">Aggiungi Stanza</button>
                <hr>
                <div>
                    <strong>Totale Superficie Radiante (mq):</strong> <span id="totalRadiantSurfaceOutput">0</span>
                </div>
            </fieldset>

            <!-- Sezione 3: Opzioni Sistema -->
            <fieldset>
                <legend>3. Opzioni e Preferenze del Sistema</legend>
                <div>
                    <label for="brandSystem">Marca Sistema Preferita:</label>
                    <select id="brandSystem" name="brandSystem">
                        <option value="eurotherm">Eurotherm</option>
                        <option value="thermolutz" selected>Thermolutz</option>
                        <option value="generic">Generico/Altro</option>
                    </select>
                </div>
                <div>
                    <label for="panelType">Tipo di Pannello Isolante:</label>
                    <select id="panelType" name="panelType">
                        <option value="bugnato">Bugnato</option>
                        <option value="liscio">Liscio (con guide/rete)</option>
                        <option value="secco">A secco / Basso spessore</option>
                        <!-- Aggiungere altri tipi se presenti nel CSV Thermolutz, es. "ZERO" -->
                         <option value="zero">ZERO (Liscio ribassato)</option>
                    </select>
                </div>
                <div>
                    <label for="panelThickness">Spessore Pannello Desiderato (mm):</label>
                    <input type="number" id="panelThickness" name="panelThickness" value="30" min="10" max="100" step="1">
                    <small>Verrà cercato il pannello Thermolutz più vicino se selezionato.</small>
                </div>
                <div>
                    <label for="pipeDiameter">Diametro Tubazione:</label>
                    <select id="pipeDiameter" name="pipeDiameter">
                        <option value="16x2">16x2 mm</option>
                        <option value="17x2">17x2 mm</option>
                    </select>
                </div>
                <div>
                    <label for="generalPipePitch">Passo di Posa Generale Desiderato (cm):</label>
                    <input type="number" id="generalPipePitch" name="generalPipePitch" value="15" min="5" max="30" step="1">
                </div>
                 <div>
                    <label for="cooling">Raffrescamento a Pavimento:</label>
                    <select id="cooling" name="cooling">
                        <option value="no">No</option>
                        <option value="yes">Sì</option>
                    </select>
                </div>
            </fieldset>

            <!-- Sezione 4: Calcola -->
            <div style="text-align: center; margin-top: 20px;">
                <button type="button" id="calculateBtn">CALCOLA CONFIGURAZIONE</button>
            </div>
        </form>

        <!-- Sezione 5: Risultati -->
        <div id="resultsSection" style="display:none;">
            <fieldset>
                <legend>5. Risultati della Configurazione (Stima)</legend>
                
                <h3>A. Riepilogo Materiali Stimati:</h3>
                <p><strong>Pannello Isolante:</strong> <span id="panelTypeOutput"></span> - <span id="insulationPanelAreaOutput"></span> mq (incluso sfrido ~7%)<br>
                <small id="thermolutzPanelInfo" class="product-info"></small></p>
                
                <p><strong>Tubazione (<span id="pipeDiameterOutput"></span>):</strong></p>
                <ul id="pipeDetailsList">
                    <li>Passo di Posa Medio Stimato: <span id="pipePitchOutput"></span> cm</li>
                    <li>Lunghezza Totale Tubo Stimata: <span id="totalPipeLengthOutput"></span> m</li>
                    <li>Numero Rotoli: <span id="pipeRollsOutput"></span></li>
                    <li id="thermolutzPipeInfo" class="product-info" style="list-style-type: none;"></li>
                </ul>

                <p><strong>Collettore/i di Distribuzione:</strong></p>
                <ul id="collectorDetailsList">
                    <li>Numero Circuiti Stimato: <span id="numCircuitsOutput"></span></li>
                    <li>Numero Collettori (max 12 vie/cad): <span id="numCollectorsOutput"></span> (es. <span id="collectorsDetailOutput"></span>)</li>
                    <li id="thermolutzCollectorInfo" class="product-info" style="list-style-type: none;"></li>
                </ul>

                <p><strong>Striscia Perimetrale Isolate:</strong> <span id="perimeterStripLengthOutput"></span> m
                <br><small id="thermolutzStripInfo" class="product-info"></small></p>
                <p><strong>Testine Elettrotermiche:</strong> <span id="actuatorsOutput"></span>
                <br><small id="thermolutzActuatorInfo" class="product-info"></small></p>
                <p><strong>Termostati Ambiente:</strong> <span id="thermostatsOutput"></span></p>
                <p id="mixingGroupNote" style="display:none;"><strong>Gruppo di Miscelazione:</strong> Probabilmente necessario.</p>
                <p id="coolingNote" style="display:none;"><strong>Raffrescamento:</strong> Considerare deumidificazione e controllo punto di rugiada.</p>

                <h3>B. Riepilogo per Stanza (Stima):</h3>
                <table id="roomResultsTable">
                    <thead>
                        <tr>
                            <th>Nome Stanza</th>
                            <th>Superficie (mq)</th>
                            <th>Passo Posa (cm)</th>
                            <th>Potenza Specifica (W/mq)*</th>
                            <th>Potenza Totale (W)*</th>
                            <th>Lunghezza Tubo (m)</th>
                            <th>N° Circuiti</th>
                        </tr>
                    </thead>
                    <tbody id="roomResultsTableBody">
                        <!-- Righe aggiunte da JavaScript -->
                    </tbody>
                </table>
                <p><small><em>*La potenza termica è una STIMA e dipende da molti fattori (temp. mandata, isolamento effettivo, perdite effettive, ecc.). Per i prodotti Thermolutz si usano i dati di resa forniti, se disponibili. Consultare un termotecnico.</em></small></p>

                <h3>C. Considerazioni Progettuali:</h3>
                <ul>
                    <li>Spessore Totale Pacchetto Stimato (escluso pavimento): <span id="totalScreedHeightOutput"></span> cm. Verificare compatibilità.</li>
                    <li>Lunghezza max circuito usata per stima: <span id="maxCircuitLengthOutput"></span> m.</li>
                    <li>È fondamentale l'equilibratura dei circuiti.</li>
                    <li>Utilizzare massetto specifico per impianti radianti.</li>
                    <li>Seguire procedura di prima accensione.</li>
                </ul>
                <p class="disclaimer"><strong>Disclaimer:</strong> I risultati sono puramente indicativi e non sostituiscono una progettazione termotecnica professionale.</p>
            </fieldset>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>